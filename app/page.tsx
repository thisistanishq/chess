"use client";
import * as React from "react";
import { BackgroundBeams } from "@/components/ui/background-beams";


import { useRef, useState, useEffect } from 'react';
import { Chessboard } from 'react-chessboard';
import type { Piece } from 'react-chessboard/dist/chessboard/types';
import { Chess } from 'chess.js';
import { Avatar, AvatarFallback, AvatarImage } from '@radix-ui/react-avatar';
import { Button } from "@/components/ui/button";
import { Separator } from "@/components/ui/separator";
import { Flag, RotateCcw, Undo2 } from 'lucide-react';

// Sound system hook
function useChessSound() {
    const playSound = (soundType: 'move' | 'capture' | 'check' | 'promote' | 'castle' | 'move-computer') => {
        try {
            let audioPath = '';
            switch (soundType) {
                case 'move':
                    audioPath = '/about-me/chess-sounds/move-self.mp3';
                    break;
                case 'move-computer':
                    audioPath = '/about-me/chess-sounds/move-opponent.mp3';
                    break;
                case 'capture':
                    audioPath = '/about-me/chess-sounds/capture.mp3';
                    break;
                case 'check':
                    audioPath = '/about-me/chess-sounds/move-check.mp3';
                    break;
                case 'castle':
                    audioPath = '/about-me/chess-sounds/castle.mp3';
                    break;
                case 'promote':
                    audioPath = '/sounds/promote.mp3';
                    break;
                default:
                    audioPath = '/about-me/chess-sounds/move-self.mp3';
            }

            const audio = new Audio(audioPath);
            audio.volume = 0.3; // Adjust volume as needed
            audio.currentTime = 0; // Reset to beginning
            audio.play().catch(e => console.log('Audio play failed:', e));

        } catch (error) {
            console.log('Sound error:', error);
        }
    };

    return { playSound };
}

export default function About() {

    const { playSound } = useChessSound();
    const chessGameRef = useRef(new Chess());
    const [chessPosition, setChessPosition] = useState(chessGameRef.current.fen());
    const stockfishRef = useRef<Worker | null>(null);
    const [waitingForBot, setWaitingForBot] = useState(false);
    const [moveHistory, setMoveHistory] = useState<string[]>([]);
    const [gameStatus, setGameStatus] = useState<string>('Game in progress');
    const [currentOpening, setCurrentOpening] = useState({ name: 'Starting position' });
    const [ecoLoaded, setEcoLoaded] = useState(false);
    const [ecoDatabase, setEcoDatabase] = useState({});
    const [avatarState, setAvatarState] = useState<'wave' | 'thinking' | 'happy' | 'illegal'>('wave');
    const [lastIllegalMove, setLastIllegalMove] = useState<{ from: string, to: string } | null>(null);
    const [positionEval, setPositionEval] = useState<number>(0);
    const promotionPieceRef = useRef<string | null>(null);

    const [capturedByWhite, setCapturedByWhite] = useState<string[]>([]);
    const [capturedByBlack, setCapturedByBlack] = useState<string[]>([]);


    const customPiecesSVG = {
        wP: ({ squareWidth }: { squareWidth: number }) => (
            <svg width={squareWidth} height={squareWidth} viewBox="0 0 162 162" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M80.0672 140.5H82.5676H119.567C119.9 136.833 119.167 127.6 113.567 120C108.234 116.833 96.8674 108.2 94.0674 99C93.4007 97.3333 92.1674 93.4 92.5674 91H101.567C102.401 90.1667 104.067 87.8 104.067 85C104.067 84.3333 103.567 82.6 101.567 81L94.5674 75.5C94.734 75 95.7674 73.1 98.5674 69.5C99.234 68.3333 100.567 64.8 100.567 60C100.234 53.8333 95.0674 41.5 81.0674 41.5C67.0674 41.5 62.4007 53.8333 62.0674 60C62.0674 64.8 63.4007 68.3333 64.0674 69.5C66.8674 73.1 67.9007 75 68.0674 75.5L61.0674 81C59.0674 82.6 58.5674 84.3333 58.5674 85C58.5674 87.8 60.234 90.1667 61.0674 91H70.0674C70.4674 93.4 69.234 97.3333 68.5674 99C65.7674 108.2 54.4009 116.833 49.0676 120C43.4676 127.6 42.7343 136.833 43.0676 140.5H80.0672Z" fill="white" />
                <path d="M82.5676 140.5H43.0676C42.7343 136.833 43.4676 127.6 49.0676 120C54.4009 116.833 65.7674 108.2 68.5674 99C69.234 97.3333 70.4674 93.4 70.0674 91H61.0674C60.234 90.1667 58.5674 87.8 58.5674 85C58.5674 84.3333 59.0674 82.6 61.0674 81L68.0674 75.5C67.9007 75 66.8674 73.1 64.0674 69.5C63.4007 68.3333 62.0674 64.8 62.0674 60C62.4007 53.8333 67.0674 41.5 81.0674 41.5C95.0674 41.5 100.234 53.8333 100.567 60C100.567 64.8 99.234 68.3333 98.5674 69.5C95.7674 73.1 94.734 75 94.5674 75.5L101.567 81C103.567 82.6 104.067 84.3333 104.067 85C104.067 87.8 102.401 90.1667 101.567 91H92.5674C92.1674 93.4 93.4007 97.3333 94.0674 99C96.8674 108.2 108.234 116.833 113.567 120C119.167 127.6 119.9 136.833 119.567 140.5H80.0672" stroke="black" strokeWidth="3" />
                <path d="M90.5674 89L91.1523 90.3652L91.0879 90.7529C90.8375 92.2552 91.1041 94.0782 91.4551 95.6104C91.8085 97.1534 92.2962 98.5991 92.6533 99.501C94.1778 104.444 97.9224 109.095 101.828 112.845C104.755 115.655 107.859 118.039 110.391 119.751C101.818 117.792 83.8948 110.287 72.0674 93.5L71.6436 92.2285C71.6526 91.7179 71.6247 91.2199 71.5469 90.7529L71.3379 89.5H70.7344L70.5674 89H90.5674Z" fill="#D9D9D9" />
                <path d="M92.9863 75.5L92.8105 76.0273L100.641 82.1797C101.473 82.8478 101.961 83.5164 102.238 84.0459C102.378 84.3132 102.464 84.5436 102.513 84.7197C102.564 84.9056 102.567 85 102.567 85C102.567 86.8884 101.597 88.5973 100.889 89.5H91.2969L91.2217 89.9453L89.5674 89C92.4007 87.6667 96.6674 83.1 91.0674 75.5H92.9863Z" fill="#D9D9D9" />
                <path d="M93.6836 48.1367C94.0689 48.5375 94.4317 48.9513 94.7715 49.376C97.6345 52.955 98.9066 57.254 99.0664 60.0459C99.0583 64.469 97.8514 67.6739 97.3037 68.6836C95.9243 70.4625 94.9614 71.842 94.3145 72.8574C93.6836 73.8475 93.292 74.5842 93.1445 75.0264L92.9863 75.501H79.5674C87.5292 72.4137 101.159 62.7065 93.6836 48.1367Z" fill="#D9D9D9" />
            </svg>
        ),

        wR: ({ squareWidth }: { squareWidth: number }) => (
            <svg width={squareWidth} height={squareWidth} viewBox="0 0 162 162" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M105.5 69.5L111.5 117.5C106.205 117.004 92.7943 116.014 81.25 116C69.7057 116.014 56.2951 117.004 51 117.5L57 69.5C61.4575 68.6745 72.489 67.0314 81.25 67.0004C90.011 67.0314 101.043 68.6745 105.5 69.5Z" fill="white" />
                <path d="M81 67C89.8 67 101 68.6667 105.5 69.5L111.5 117.5C106.167 117 92.6 116 81 116M81.5 67C72.7 67 61.5 68.6667 57 69.5L51 117.5C56.3333 117 69.9 116 81.5 116" stroke="black" strokeWidth="3" />
                <path d="M116 56.5C116 63.3 109.667 67.6667 106.5 69C97 67.6667 73.6 65.8 56 69C52.8333 67.6667 46.5 63.3 46.5 56.5L46 39C48.8333 37.6667 55.5 35 59.5 35L63 49H70.5L72.5 33.5C74.0521 33.3448 77.8304 33.045 81.25 33.0046C84.6696 33.045 88.4478 33.3448 90 33.5L92 49H99.5L103 35C107 35 113.667 37.6667 116.5 39L116 56.5Z" fill="white" />
                <path d="M80.5 33C84.1 33 88.3333 33.3333 90 33.5L92 49H99.5L103 35C107 35 113.667 37.6667 116.5 39L116 56.5C116 63.3 109.667 67.6667 106.5 69C97 67.6667 73.6 65.8 56 69C52.8333 67.6667 46.5 63.3 46.5 56.5L46 39C48.8333 37.6667 55.5 35 59.5 35L63 49H70.5L72.5 33.5C74.1667 33.3333 78.4 33 82 33" stroke="black" strokeWidth="3" />
                <path d="M38 131.001V141.001H123.001V131.001C123.001 127.334 120.201 119.501 109.001 117.501C103.073 116.512 94.2155 116.5 80.5005 116.5C66.7854 116.5 57.9283 116.512 52 117.501C40.8 119.501 38 127.334 38 131.001Z" fill="white" />
                <path d="M81 116.5H80.984C66.9932 116.5 57.9977 116.5 52 117.501C40.8 119.501 38 127.334 38 131.001V141.001H123.001V131.001C123.001 127.334 120.201 119.501 109.001 117.501C103.003 116.5 94.0078 116.5 80.017 116.5H80.001" stroke="black" strokeWidth="3" />
                <path d="M81.25 68.5C89.2429 68.5288 99.2089 69.9248 104.148 70.7812L109.781 115.842C107.206 115.623 103.628 115.356 99.5752 115.117C100.779 99.9465 97.1631 71.9614 74.3848 68.7939C76.7254 68.6202 79.0616 68.5079 81.25 68.5Z" fill="#D9D9D9" />
                <path d="M110.062 38.0391C111.92 38.6681 113.675 39.3789 114.972 39.9521L114.501 56.4561L114.5 56.4775V56.499C114.5 59.403 113.153 61.8456 111.344 63.7725C109.674 65.5511 107.687 66.8013 106.278 67.4551C104.265 67.181 101.69 66.8884 98.7168 66.623C107.5 57.8398 110.062 52.5 110.062 38.0391Z" fill="#D9D9D9" />
            </svg>


        ),

        wN: ({ squareWidth }: { squareWidth: number }) => (
            <svg width={squareWidth} height={squareWidth} viewBox="0 0 162 162" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M70.9997 95C58.1997 106.6 56 115.167 56.5 117.5C73.5 114.5 107 115.5 118.5 117.5C124.1 100.7 125.167 88.3333 125 84C125 72 119 59.6667 116 55C107.2 39.758 88 34.6491 79.5 34L68 23.5C64 23.5 62 31.1667 61.5 35C58.3 38.2 53.1667 43.6667 51 46C51 50.8 46 60.3333 43.5 64.5C38.3 72.1 33.6667 78.6667 32 81V84C34.0364 91.6 45.5152 94.5 51 95L59 85C62.2 85 66.3333 84.3333 68 84C74 81.6 79.5 76 81.5 73.5C83.1 74.7 83.5 78.3333 83.5 80C81.1 86.4 74.1665 92.6667 70.9997 95Z" fill="white" />
                <path d="M45 130.501V140.501H130.001V130.501C130.001 126.834 127.201 119.001 116.001 117.001C110.073 116.012 101.216 116 87.5005 116C73.7854 116 64.9283 116.012 59 117.001C47.8 119.001 45 126.834 45 130.501Z" fill="white" />
                <path d="M70.9997 95C58.1997 106.6 56 115.167 56.5 117.5C73.5 114.5 107 115.5 118.5 117.5C124.1 100.7 125.167 88.3333 125 84C125 72 119 59.6667 116 55C107.2 39.758 88 34.6491 79.5 34L68 23.5C64 23.5 62 31.1667 61.5 35C58.3 38.2 53.1667 43.6667 51 46C51 50.8 46 60.3333 43.5 64.5C38.3 72.1 33.6667 78.6667 32 81V84C34.0364 91.6 45.5152 94.5 51 95L59 85C62.2 85 66.3333 84.3333 68 84C74 81.6 79.5 76 81.5 73.5C83.1 74.7 83.5 78.3333 83.5 80C81.1 86.4 74.1665 92.6667 70.9997 95Z" stroke="black" strokeWidth="3" />
                <path d="M45 130.501V140.501H130.001V130.501C130.001 126.834 127.201 119.001 116.001 117.001C110.073 116.012 101.216 116 87.5005 116C73.7854 116 64.9283 116.012 59 117.001C47.8 119.001 45 126.834 45 130.501Z" stroke="black" strokeWidth="3" />
                <path d="M92.7803 38.6221C94.1693 39.137 95.5843 39.7227 97.001 40.3867C103.788 43.5679 110.503 48.4789 114.701 55.751L114.719 55.7822L114.738 55.8125C117.661 60.3585 123.5 72.4051 123.5 84.001V84.0303L123.501 84.0586C123.655 88.0698 122.682 99.7648 117.473 115.817C117.121 115.765 116.754 115.714 116.374 115.663C116.214 115.642 116.052 115.622 115.887 115.601C115.669 115.573 115.447 115.545 115.222 115.518C115.031 115.495 114.837 115.473 114.641 115.45C114.39 115.421 114.134 115.392 113.874 115.364C113.715 115.347 113.554 115.329 113.392 115.312C113.051 115.277 112.703 115.243 112.348 115.209C112.232 115.198 112.117 115.187 112 115.176C111.627 115.141 111.247 115.107 110.86 115.073C110.593 115.05 110.322 115.027 110.048 115.005C109.704 114.977 109.355 114.947 109.002 114.92C108.876 114.91 108.75 114.901 108.623 114.892C108.24 114.863 107.852 114.835 107.459 114.808C107.217 114.791 106.973 114.774 106.727 114.758C106.501 114.743 106.274 114.728 106.045 114.714C105.735 114.694 105.423 114.674 105.107 114.655C104.777 114.635 104.443 114.617 104.106 114.598C103.897 114.586 103.686 114.573 103.475 114.562C103.288 114.551 103.1 114.543 102.911 114.533C102.19 114.496 101.458 114.461 100.716 114.428C100.51 114.419 100.302 114.409 100.095 114.4C99.8122 114.388 99.5283 114.377 99.2432 114.366C98.905 114.353 98.5652 114.34 98.2236 114.327C97.9444 114.317 97.6641 114.307 97.3828 114.298C97.0231 114.286 96.6617 114.275 96.2988 114.264C96.0469 114.256 95.7943 114.248 95.541 114.241C95.4847 114.24 95.4284 114.238 95.3721 114.236C97.2756 108.147 103.649 98.501 110 87.501C113.874 80.791 115.222 62.9195 109 55.001C106.028 51.2185 99.3345 43.6464 92.6445 38.5703C92.6899 38.587 92.7348 38.6052 92.7803 38.6221Z" fill="#D9D9D9" />
                <path d="M58 79C59.5257 79.4161 62.666 80.7336 64.8301 83.0078C63.0239 83.2652 60.8371 83.5 59 83.5H58.2793L50.3428 93.4199C49.9424 93.3709 49.5177 93.3084 49.0732 93.2354C51.1483 88.7421 55.0951 81.1787 58 79Z" fill="#D9D9D9" />
                <path d="M84.5596 76.2295C84.8914 77.6306 85 79.0744 85 80C86.6667 76.6667 89.6 68.2 88 61C86.7687 63.4626 83.879 68.2544 81.7012 71.7754L82.4004 72.2998C83.6555 73.2412 84.2498 74.9216 84.5596 76.2295Z" fill="#D9D9D9" />
                <path d="M73.5003 51.5C73.5003 53.1569 70.2094 56 68.0003 56C66.5552 56 65.5001 56 62 56C61.3937 55.6229 62.366 54 62.5003 53.5C63.0001 52 66.7912 47.5 69.0003 47.5C71.2094 47.5 73.5003 49.8431 73.5003 51.5Z" fill="black" />
            </svg>

        ),

        wB: ({ squareWidth }: { squareWidth: number }) => (
            <svg width={squareWidth} height={squareWidth} viewBox="0 0 162 162" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M95.0002 45.5C127 77.5 113 105.5 102 115.5C94.7996 114.7 69.0002 115.167 57.0005 115.5C30.5003 83.5 54.3339 52.5 70.5006 38.5C64.0126 27.2624 73.5 21 79.0006 21C86.6006 21 89.5003 28 90.0002 31.5C76.8002 44.7 74.1668 71.6667 74.5002 83.5H85.5002C85.5002 65.5 91.8335 50.6667 95.0002 45.5Z" fill="white" stroke="black" strokeWidth="3" />
                <path d="M38 130.501V140.501H123.001V130.501C123.001 126.834 120.201 119.001 109.001 117.001C103.073 116.012 94.2155 116 80.5005 116C66.7854 116 57.9283 116.012 52 117.001C40.8 119.001 38 126.834 38 130.501Z" fill="white" />
                <path d="M81 116H80.984C66.9932 116 57.9977 116 52 117.001C40.8 119.001 38 126.834 38 130.501V140.501H123.001V130.501C123.001 126.834 120.201 119.001 109.001 117.001C103.003 116 94.0078 116 80.017 116H80.001" stroke="black" strokeWidth="3" />
                <path d="M96.3389 116.681C98.0018 116.73 99.445 116.796 100.599 116.882L100.5 117.001L96.3389 116.681Z" fill="#D9D9D9" />
                <path d="M106.036 61.7578C111.959 71.6584 113.69 80.7891 113.129 88.6445C112.311 100.093 106.614 109.048 101.473 113.941C98.0219 113.637 91.6473 113.544 84.6094 113.561C91.5188 109.24 101.99 99.5316 107 83.501C108.876 76.5 107.605 68.4288 106.036 61.7578Z" fill="#D9D9D9" />
                <path d="M83.9994 23.9883C84.772 24.5221 85.4292 25.168 85.9877 25.8711C87.3095 27.5354 88.0593 29.5102 88.3852 31.0098C81.8268 37.8985 77.9404 47.975 75.7123 57.6777C73.4143 67.6851 72.8306 77.513 73.0004 83.543L73.0346 84.7852H72C68.6667 79.1185 64.9985 64.7009 74.9984 49.501L83.9994 33.001V23.9883Z" fill="#D9D9D9" />
            </svg>

        ),

        wQ: ({ squareWidth }: { squareWidth: number }) => (
            <svg width={squareWidth} height={squareWidth} viewBox="0 0 162 162" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M129 70.9996L110 116.5C99.3333 115.666 72.7 114.399 51.5 116L32.5 70.4996C29 69.4996 23.0004 65 23 58.4996C23 54.5 27.4996 47.4996 34.9996 47.4996C37.9996 47.4996 45.9996 50 45.9996 58.4996C45.9996 60 45.6996 63.8 44.4996 65L57.9996 79L58.9996 47C55.8329 44.8333 51.9996 42 51.9996 34.5C51.9996 32 54.4996 23 62.9996 23C70.4996 23 75.4996 28 75.4996 34C75.4996 38 74.8996 43.3 70.4996 44.5L80.5 72L91.0004 45C86.6004 43.8 86.0004 38.5 86.0004 34.5C86.0004 28.5 91.0004 23.5 98.5004 23.5C107 23.5 109.5 32.5 109.5 35C109.5 42.5 105.667 45.3333 102.5 47.5L103.5 79.5L117 65.5C115.8 64.3 115.5 60.5 115.5 58.9996C115.5 50.5 123.5 47.9996 126.5 47.9996C134 47.9996 138.5 55 138.5 58.9996C138.5 65.5 132.5 69.9996 129 70.9996Z" fill="white" stroke="black" strokeWidth="3" />
                <path d="M133.5 52.5C133.602 52.5255 133.708 52.5635 133.817 52.6094C133.951 52.7418 134.081 52.8762 134.207 53.0137C136.085 55.0631 137 57.4673 137 59C137 61.7653 135.725 64.1654 133.969 66.0352C132.196 67.9226 130.049 69.14 128.588 69.5576L127.894 69.7559L109.032 114.925C103.472 114.516 94.4551 114.032 84.2764 113.829C89.2306 112.653 100.757 104.978 117.5 79.5L124 67.5C124.333 66.8333 125.4 65.4 127 65C130.167 64.1667 135.9 60.1 133.5 52.5Z" fill="#D9D9D9" />
                <path d="M105.179 28.123C105.452 28.4491 105.705 28.7878 105.935 29.1377C107.469 31.4673 108 34.0575 108 35C108 38.4707 107.121 40.7453 105.963 42.3848C104.778 44.0613 103.231 45.1819 101.653 46.2617L100.975 46.7256L101.543 64.9102C99.4113 59.7428 95.7708 49.4328 98.0006 42C99.8999 38.7104 105.95 32.1959 105.179 28.123Z" fill="#D9D9D9" />
                <path d="M71.9176 28.2715C73.2654 29.8907 73.9996 31.8924 73.9996 34C73.9996 35.9584 73.8467 38.0729 73.235 39.7988C72.6386 41.4814 71.6783 42.6234 70.1041 43.0527L68.5328 43.4814L74.7848 60.6748C71.4911 55.6826 63.9517 44.9126 65.0006 41C65.9323 37.5228 71.2018 31.9306 71.9176 28.2715Z" fill="#D9D9D9" />
                <path d="M39.7002 50.377C40.056 50.5724 40.4109 50.79 40.7559 51.0352C42.7953 52.4843 44.5 54.8057 44.5 58.5C44.5 59.1776 44.4295 60.4151 44.2217 61.6045C44.1179 62.1984 43.9861 62.7426 43.8281 63.1826C43.6605 63.6495 43.5085 63.8694 43.4385 63.9395L42.3975 64.9805L47.8086 70.5918L38.5 63.5C38.5 60.1665 40.8582 53.1139 39.7002 50.377Z" fill="#D9D9D9" />
                <path d="M38 130.501V140.501H123.001V130.501C123.001 126.834 120.201 119.001 109.001 117.001C103.073 116.012 94.2155 116 80.5005 116C66.7854 116 57.9283 116.012 52 117.001C40.8 119.001 38 126.834 38 130.501Z" fill="white" />
                <path d="M81 116H80.984C66.9932 116 57.9977 116 52 117.001C40.8 119.001 38 126.834 38 130.501V140.501H123.001V130.501C123.001 126.834 120.201 119.001 109.001 117.001C103.003 116 94.0078 116 80.017 116H80.001" stroke="black" strokeWidth="3" />
            </svg>
        ),

        wK: ({ squareWidth }: { squareWidth: number }) => (
            <svg width={squareWidth} height={squareWidth} viewBox="0 0 162 162" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M89.9997 28H99.4997V46H90.946L92.4626 51.7627C102.552 46.5 111.567 46.756 118.806 49.4033C126.146 52.0877 131.576 57.193 134.468 61.2646L134.739 61.6553L134.771 61.7012L134.799 61.75C139.059 69.1294 139.367 76.7111 138.207 82.8271C137.627 85.8834 136.678 88.5917 135.658 90.7559C134.651 92.8921 133.532 94.5887 132.56 95.5605C126.624 101.496 117.009 113.099 113.218 118.375L112.69 119.109L111.795 118.986C88.7745 115.811 60.9768 117.663 49.9685 118.989L49.0886 119.096L48.571 118.375C44.7791 113.099 35.1641 101.496 29.2283 95.5605C28.2564 94.5887 27.1375 92.8922 26.1306 90.7559C25.1106 88.5916 24.1616 85.8834 23.5818 82.8271C22.4216 76.711 22.7294 69.1295 26.99 61.75L27.0183 61.7012L27.0495 61.6553C29.8652 57.5248 35.4059 52.1742 42.9822 49.4033C50.2211 46.7561 59.2365 46.4999 69.3259 51.7627L70.8435 46H62.2888V28H71.7888V18H89.9997V28ZM54.8445 69.9785L54.1531 70.002L53.9958 70.0098L53.8435 70.0508C49.886 71.1114 47.9547 73.6598 47.2868 76.4287C46.6499 79.0699 47.1754 81.8065 47.8298 83.5312L47.9284 83.791L61.0603 98.499H70.2322V75.3779L69.7927 74.9385C67.5147 72.6606 64.3756 71.4044 61.5154 70.7275C58.9974 70.1317 56.5628 69.9532 54.8445 69.9785ZM106.387 69.9785C104.669 69.9532 102.234 70.1317 99.7165 70.7275C96.8564 71.4044 93.7172 72.6607 91.4392 74.9385L90.9997 75.3779V98.499H100.172L113.303 83.791L113.402 83.5312C114.057 81.8066 114.582 79.0698 113.945 76.4287C113.277 73.6599 111.346 71.1114 107.388 70.0508L107.236 70.0098L107.079 70.002L106.387 69.9785Z" fill="white" />
                <path d="M131.499 94.5C125.499 100.5 115.832 112.167 111.999 117.5C88.7992 114.3 60.8585 116.167 49.7882 117.5C45.9548 112.167 36.2882 100.5 30.2882 94.5C27.0821 91.2939 20.2053 76.5 28.2882 62.5C33.6279 54.6667 49.5036 42 70.2882 54L72.7882 44.5H63.7882V29.5H73.2882V19.5H88.4991V29.5H97.9991V44.5H88.9991L91.4991 54C112.284 42 128.159 54.6667 133.499 62.5C141.582 76.5 134.705 91.2939 131.499 94.5Z" stroke="black" strokeWidth="3" />
                <path d="M38.499 130.501V140.501H123.5V130.501C123.5 126.834 120.7 119.001 109.5 117.001C103.572 116.012 94.7146 116 80.9995 116C67.2845 116 58.4274 116.012 52.499 117.001C41.299 119.001 38.499 126.834 38.499 130.501Z" fill="white" />
                <path d="M81.499 116H81.483C67.4922 116 58.4967 116 52.499 117.001C41.299 119.001 38.499 126.834 38.499 130.501V140.501H123.5V130.501C123.5 126.834 120.7 119.001 109.5 117.001C103.502 116 94.5068 116 80.516 116H80.5" stroke="black" strokeWidth="3" />
                <path d="M99.499 96.9995H92.499V75.9995C96.499 71.9995 103.832 71.3328 106.999 71.4995C113.799 73.3216 113.166 79.9254 111.999 82.9995L99.499 96.9995Z" stroke="black" strokeWidth="3" />
                <path d="M61.7324 96.9995H68.7324V75.9995C64.7324 71.9995 57.3991 71.3328 54.2324 71.4995C47.4324 73.3216 48.0658 79.9254 49.2324 82.9995L61.7324 96.9995Z" stroke="black" strokeWidth="3" />
                <path d="M130.983 61.6484C131.447 62.2152 131.863 62.7677 132.226 63.2969C136.023 69.9031 136.315 76.7 135.259 82.2695C134.729 85.0622 133.863 87.5288 132.944 89.4775C132.013 91.4541 131.07 92.8093 130.438 93.4404C124.636 99.2432 115.488 110.235 111.315 115.896C108.156 115.479 104.917 115.156 101.65 114.908C110.386 106.979 128.324 88.5 131.499 83.001C134.674 77.502 132.834 67.7133 130.983 61.6484Z" fill="#D9D9D9" />
            </svg>
        ),

        bP: ({ squareWidth }: { squareWidth: number }) => (
            <svg width={squareWidth} height={squareWidth} viewBox="0 0 162 162" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M80.0672 140.5H82.5676H119.567C119.9 136.833 119.167 127.6 113.567 120C108.234 116.833 96.8674 108.2 94.0674 99C93.4007 97.3333 92.1674 93.4 92.5674 91H101.567C102.401 90.1667 104.067 87.8 104.067 85C104.067 84.3333 103.567 82.6 101.567 81L94.5674 75.5C94.734 75 95.7674 73.1 98.5674 69.5C99.234 68.3333 100.567 64.8 100.567 60C100.234 53.8333 95.0674 41.5 81.0674 41.5C67.0674 41.5 62.4007 53.8333 62.0674 60C62.0674 64.8 63.4007 68.3333 64.0674 69.5C66.8674 73.1 67.9007 75 68.0674 75.5L61.0674 81C59.0674 82.6 58.5674 84.3333 58.5674 85C58.5674 87.8 60.234 90.1667 61.0674 91H70.0674C70.4674 93.4 69.234 97.3333 68.5674 99C65.7674 108.2 54.4009 116.833 49.0676 120C43.4676 127.6 42.7343 136.833 43.0676 140.5H80.0672Z" fill="#5C5957" />
                <path d="M82.5676 140.5H43.0676C42.7343 136.833 43.4676 127.6 49.0676 120C54.4009 116.833 65.7674 108.2 68.5674 99C69.234 97.3333 70.4674 93.4 70.0674 91H61.0674C60.234 90.1667 58.5674 87.8 58.5674 85C58.5674 84.3333 59.0674 82.6 61.0674 81L68.0674 75.5C67.9007 75 66.8674 73.1 64.0674 69.5C63.4007 68.3333 62.0674 64.8 62.0674 60C62.4007 53.8333 67.0674 41.5 81.0674 41.5C95.0674 41.5 100.234 53.8333 100.567 60C100.567 64.8 99.234 68.3333 98.5674 69.5C95.7674 73.1 94.734 75 94.5674 75.5L101.567 81C103.567 82.6 104.067 84.3333 104.067 85C104.067 87.8 102.401 90.1667 101.567 91H92.5674C92.1674 93.4 93.4007 97.3333 94.0674 99C96.8674 108.2 108.234 116.833 113.567 120C119.167 127.6 119.9 136.833 119.567 140.5H80.0672" stroke="black" strokeWidth="3" />
                <path d="M90.5674 89L91.1523 90.3652L91.0879 90.7529C90.8375 92.2552 91.1041 94.0782 91.4551 95.6104C91.8085 97.1534 92.2962 98.5991 92.6533 99.501C94.1778 104.444 97.9224 109.095 101.828 112.845C104.755 115.655 107.859 118.039 110.391 119.751C101.818 117.792 83.8948 110.287 72.0674 93.5L71.6436 92.2285C71.6526 91.7179 71.6247 91.2199 71.5469 90.7529L71.3379 89.5H70.7344L70.5674 89H90.5674Z" fill="#474543" />
                <path d="M92.9863 75.5L92.8105 76.0273L100.641 82.1797C101.473 82.8478 101.961 83.5164 102.238 84.0459C102.378 84.3132 102.464 84.5436 102.513 84.7197C102.564 84.9056 102.567 85 102.567 85C102.567 86.8884 101.597 88.5973 100.889 89.5H91.2969L91.2217 89.9453L89.5674 89C92.4007 87.6667 96.6674 83.1 91.0674 75.5H92.9863Z" fill="#474543" />
                <path d="M93.6836 48.1367C94.0689 48.5375 94.4317 48.9513 94.7715 49.376C97.6345 52.955 98.9066 57.254 99.0664 60.0459C99.0583 64.469 97.8514 67.6739 97.3037 68.6836C95.9243 70.4625 94.9614 71.842 94.3145 72.8574C93.6836 73.8475 93.292 74.5842 93.1445 75.0264L92.9863 75.501H79.5674C87.5292 72.4137 101.159 62.7065 93.6836 48.1367Z" fill="#474543" />
                <path d="M70.0078 99.4258C69.4202 111.329 64.5699 116.749 62.0674 118C48.4674 125.852 45.0674 134.938 45.0674 138.5L44.5273 137.779C44.7067 133.599 45.9649 126.879 50.1084 121.123C52.8675 119.454 56.9872 116.512 60.8066 112.845C64.7123 109.095 68.4559 104.444 69.9805 99.501C69.9901 99.4766 69.998 99.451 70.0078 99.4258Z" fill="#85817E" />
                <path d="M79.6934 43.0449C69.5835 47.6209 65.498 60.0741 64.6299 66.9707C64.1099 65.3937 63.5726 62.9883 63.5674 60.043C63.7284 57.2182 64.8946 52.9167 67.6318 49.3506C70.1397 46.0833 73.9731 43.4144 79.6934 43.0449Z" fill="#85817E" />
                <path d="M69.0674 82.501L61.2275 82.8926C61.4434 82.6597 61.6963 82.4198 61.9941 82.1807L69.5117 76.2734L69.0674 82.501Z" fill="#85817E" />
            </svg>

        ),

        bB: ({ squareWidth }: { squareWidth: number }) => (
            <svg width={squareWidth} height={squareWidth} viewBox="0 0 162 162" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M95.0002 45.5C127 77.5 113 105.5 102 115.5C94.7996 114.7 69.0002 115.167 57.0005 115.5C30.5003 83.5 54.3339 52.5 70.5006 38.5C64.0126 27.2624 73.5 21 79.0006 21C86.6006 21 89.5003 28 90.0002 31.5C76.8002 44.7 74.1668 71.6667 74.5002 83.5H85.5002C85.5002 65.5 91.8335 50.6667 95.0002 45.5Z" fill="#5C5957" stroke="black" strokeWidth="3" />
                <path d="M38 130.501V140.501H123.001V130.501C123.001 126.834 120.201 119.001 109.001 117.001C103.073 116.012 94.2155 116 80.5005 116C66.7854 116 57.9283 116.012 52 117.001C40.8 119.001 38 126.834 38 130.501Z" fill="#5C5957" />
                <path d="M81 116H80.984C66.9932 116 57.9977 116 52 117.001C40.8 119.001 38 126.834 38 130.501V140.501H123.001V130.501C123.001 126.834 120.201 119.001 109.001 117.001C103.003 116 94.0078 116 80.017 116H80.001" stroke="black" strokeWidth="3" />
                <path d="M96.3389 116.681C98.0018 116.73 99.445 116.796 100.599 116.882L100.5 117.001L96.3389 116.681Z" fill="#474543" />
                <path d="M106.036 61.7578C111.959 71.6584 113.69 80.7891 113.129 88.6445C112.311 100.093 106.614 109.048 101.473 113.941C98.0219 113.637 91.6473 113.544 84.6094 113.561C91.5188 109.24 101.99 99.5316 107 83.501C108.876 76.5 107.605 68.4288 106.036 61.7578Z" fill="#474543" />
                <path d="M83.9994 23.9883C84.772 24.5221 85.4292 25.168 85.9877 25.8711C87.3095 27.5354 88.0593 29.5102 88.3852 31.0098C81.8268 37.8985 77.9404 47.975 75.7123 57.6777C73.4143 67.6851 72.8306 77.513 73.0004 83.543L73.0346 84.7852H72C68.6667 79.1185 64.9985 64.7009 74.9984 49.501L83.9994 33.001V23.9883Z" fill="#474543" />
                <path d="M80.4941 117.5C94.267 117.5 102.965 117.516 108.74 118.479C115.311 119.654 118.668 122.938 120.251 125.958C114.749 122.81 91.1811 122 79.4941 122C61.0438 122 46.9287 124.453 40.7002 126.032C42.2669 122.992 45.6244 119.664 52.248 118.479C58.0233 117.516 66.7211 117.5 80.4941 117.5Z" fill="#84807D" />
                <path d="M73.9999 41.5014C75 39.7692 76 38.5 73 38.4922C72.9459 38.5453 73 38.4976 72.4188 38.8246L71.4823 39.6352C63.5017 46.5463 53.7145 57.589 49.1679 70.7416C46.7558 77.7193 45.8099 85.311 47.4227 93.2455L48.9999 98.5014C49.8332 84.3348 54.8001 54.3015 73.9999 41.5014Z" fill="#85817E" />
                <path d="M77.0771 22.7656C73.4201 25.507 71.0113 29.687 69.8848 32.4609C69.825 31.9738 69.8045 31.5093 69.8174 31.0674C69.8706 29.2385 70.4984 27.6991 71.4512 26.4404C72.9054 24.5195 75.1021 23.2769 77.0771 22.7656Z" fill="#85817E" />
            </svg>
        ),

        bR: ({ squareWidth }: { squareWidth: number }) => (
            <svg width={squareWidth} height={squareWidth} viewBox="0 0 162 162" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M105.5 69.5L111.5 117.5C106.205 117.004 92.7943 116.014 81.25 116C69.7057 116.014 56.2951 117.004 51 117.5L57 69.5C61.4575 68.6745 72.489 67.0314 81.25 67.0004C90.011 67.0314 101.043 68.6745 105.5 69.5Z" fill="#5C5957" />
                <path d="M81 67C89.8 67 101 68.6667 105.5 69.5L111.5 117.5C106.167 117 92.6 116 81 116M81.5 67C72.7 67 61.5 68.6667 57 69.5L51 117.5C56.3333 117 69.9 116 81.5 116" stroke="black" strokeWidth="3" />
                <path d="M116 56.5C116 63.3 109.667 67.6667 106.5 69C97 67.6667 73.6 65.8 56 69C52.8333 67.6667 46.5 63.3 46.5 56.5L46 39C48.8333 37.6667 55.5 35 59.5 35L63 49H70.5L72.5 33.5C74.0521 33.3448 77.8304 33.045 81.25 33.0046C84.6696 33.045 88.4478 33.3448 90 33.5L92 49H99.5L103 35C107 35 113.667 37.6667 116.5 39L116 56.5Z" fill="#5C5957" />
                <path d="M80.5 33C84.1 33 88.3333 33.3333 90 33.5L92 49H99.5L103 35C107 35 113.667 37.6667 116.5 39L116 56.5C116 63.3 109.667 67.6667 106.5 69C97 67.6667 73.6 65.8 56 69C52.8333 67.6667 46.5 63.3 46.5 56.5L46 39C48.8333 37.6667 55.5 35 59.5 35L63 49H70.5L72.5 33.5C74.1667 33.3333 78.4 33 82 33" stroke="black" strokeWidth="3" />
                <path d="M38 131.001V141.001H123.001V131.001C123.001 127.334 120.201 119.501 109.001 117.501C103.073 116.512 94.2155 116.5 80.5005 116.5C66.7854 116.5 57.9283 116.512 52 117.501C40.8 119.501 38 127.334 38 131.001Z" fill="#5C5957" />
                <path d="M81 116.5H80.984C66.9932 116.5 57.9977 116.5 52 117.501C40.8 119.501 38 127.334 38 131.001V141.001H123.001V131.001C123.001 127.334 120.201 119.501 109.001 117.501C103.003 116.5 94.0078 116.5 80.017 116.5H80.001" stroke="black" strokeWidth="3" />
                <path d="M81.25 68.5C89.2429 68.5288 99.2089 69.9248 104.148 70.7812L109.781 115.842C107.206 115.623 103.628 115.356 99.5752 115.117C100.779 99.9465 97.1631 71.9614 74.3848 68.7939C76.7254 68.6202 79.0616 68.5079 81.25 68.5Z" fill="#474543" />
                <path d="M110.062 38.0391C111.92 38.6681 113.675 39.3789 114.972 39.9521L114.501 56.4561L114.5 56.4775V56.499C114.5 59.403 113.153 61.8456 111.344 63.7725C109.674 65.5511 107.687 66.8013 106.278 67.4551C104.265 67.181 101.69 66.8884 98.7168 66.623C107.5 57.8398 110.062 52.5 110.062 38.0391Z" fill="#474543" />
                <path d="M80.4941 118C94.267 118 102.965 118.016 108.74 118.979C115.311 120.154 118.668 123.438 120.251 126.458C114.749 123.31 91.1811 122.5 79.4941 122.5C61.0438 122.5 46.9287 124.953 40.7002 126.532C42.2669 123.492 45.6244 120.164 52.248 118.979C58.0233 118.016 66.7211 118 80.4941 118Z" fill="#84807D" />
                <path d="M104.152 36.5723C105.575 36.7338 107.289 37.1558 109.046 37.708L102.366 43.7207L104.152 36.5723Z" fill="#85817E" />
                <path d="M72.8291 42.6699L73.833 34.8848C75.6151 34.7353 78.3899 34.5528 80.9863 34.5117L72.8291 42.6699Z" fill="#85817E" />
                <path d="M54.2773 37.457C50.8346 44.0462 50.3821 56.627 50.4922 63.0156C50.2997 62.7796 50.1155 62.5364 49.9395 62.2871L48.2451 58.6152C48.0869 57.9403 48 57.235 48 56.5V56.4785L47.999 56.457L47.5273 39.9531C48.9037 39.3444 50.7982 38.58 52.7832 37.9238C53.2841 37.7582 53.784 37.6013 54.2773 37.457Z" fill="#85817E" />
            </svg>

        ),
        bN: ({ squareWidth }: { squareWidth: number }) => (
            <svg width={squareWidth} height={squareWidth} viewBox="0 0 162 162" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M70.9997 95C58.1997 106.6 56 115.167 56.5 117.5C73.5 114.5 107 115.5 118.5 117.5C124.1 100.7 125.167 88.3333 125 84C125 72 119 59.6667 116 55C107.2 39.758 88 34.6491 79.5 34L68 23.5C64 23.5 62 31.1667 61.5 35C58.3 38.2 53.1667 43.6667 51 46C51 50.8 46 60.3333 43.5 64.5C38.3 72.1 33.6667 78.6667 32 81V84C34.0364 91.6 45.5152 94.5 51 95L59 85C62.2 85 66.3333 84.3333 68 84C74 81.6 79.5 76 81.5 73.5C83.1 74.7 83.5 78.3333 83.5 80C81.1 86.4 74.1665 92.6667 70.9997 95Z" fill="#5C5957" stroke="black" strokeWidth="3" />
                <path d="M92.7803 38.6221C94.1693 39.137 95.5843 39.7227 97.001 40.3867C103.788 43.5679 110.503 48.4789 114.701 55.751L114.719 55.7822L114.738 55.8125C117.661 60.3585 123.5 72.4051 123.5 84.001V84.0303L123.501 84.0586C123.655 88.0698 122.682 99.7648 117.473 115.817C117.121 115.765 116.754 115.714 116.374 115.663C116.214 115.642 116.052 115.622 115.887 115.601C115.669 115.573 115.447 115.545 115.222 115.518C115.031 115.495 114.837 115.473 114.641 115.45C114.39 115.421 114.134 115.392 113.874 115.364C113.715 115.347 113.554 115.329 113.392 115.312C113.051 115.277 112.703 115.243 112.348 115.209C112.232 115.198 112.117 115.187 112 115.176C111.627 115.141 111.247 115.107 110.86 115.073C110.593 115.05 110.322 115.027 110.048 115.005C109.704 114.977 109.355 114.947 109.002 114.92C108.876 114.91 108.75 114.901 108.623 114.892C108.24 114.863 107.852 114.835 107.459 114.808C107.217 114.791 106.973 114.774 106.727 114.758C106.501 114.743 106.274 114.728 106.045 114.714C105.735 114.694 105.423 114.674 105.107 114.655C104.777 114.635 104.443 114.617 104.106 114.598C103.897 114.586 103.686 114.573 103.475 114.562C103.288 114.551 103.1 114.543 102.911 114.533C102.19 114.496 101.458 114.461 100.716 114.428C100.51 114.419 100.302 114.409 100.095 114.4C99.8122 114.388 99.5283 114.377 99.2432 114.366C98.905 114.353 98.5652 114.34 98.2236 114.327C97.9444 114.317 97.6641 114.307 97.3828 114.298C97.0231 114.286 96.6617 114.275 96.2988 114.264C96.0469 114.256 95.7943 114.248 95.541 114.241C95.4847 114.24 95.4284 114.238 95.3721 114.236C97.2756 108.147 103.649 98.501 110 87.501C113.874 80.791 115.222 62.9195 109 55.001C106.028 51.2185 99.3345 43.6464 92.6445 38.5703C92.6899 38.587 92.7348 38.6052 92.7803 38.6221Z" fill="#474543" />
                <path d="M58 79C59.5257 79.4161 62.666 80.7336 64.8301 83.0078C63.0239 83.2652 60.8371 83.5 59 83.5H58.2793L50.3428 93.4199C49.9424 93.3709 49.5177 93.3084 49.0732 93.2354C51.1483 88.7421 55.0951 81.1787 58 79Z" fill="#474543" />
                <path d="M84.5596 76.2295C84.8914 77.6306 85 79.0744 85 80C86.6667 76.6667 89.6 68.2 88 61C86.7687 63.4626 83.879 68.2544 81.7012 71.7754L82.4004 72.2998C83.6555 73.2412 84.2498 74.9216 84.5596 76.2295Z" fill="#474543" />
                <path d="M73.5003 51.5C73.5003 53.1569 70.2094 56 68.0003 56C66.5552 56 65.5001 56 62 56C61.3937 55.6229 62.366 54 62.5003 53.5C63.0001 52 66.7912 47.5 69.0003 47.5C71.2094 47.5 73.5003 49.8431 73.5003 51.5Z" fill="black" />
                <path d="M70.3389 27.668C70.6205 33.1364 67.6892 36.7049 66.4424 38C56.8424 43.5426 55.5986 54 53 58.501L33.668 84.2871C33.6066 84.1226 33.5498 83.9562 33.5 83.7871V81.4785C35.3694 78.8532 39.7995 72.5658 44.7383 65.3477L44.7637 65.3115L44.7861 65.2725C46.0612 63.1473 47.9662 59.6686 49.5576 56.0996C50.3535 54.3146 51.0812 52.484 51.6123 50.7754C52.0626 49.3265 52.3919 47.8942 52.4766 46.6172C54.814 44.1066 59.554 39.0681 62.5605 36.0615L62.9219 35.7012L62.9873 35.1953C63.2255 33.3691 63.8228 30.645 64.8086 28.4219C65.3027 27.3078 65.8569 26.4063 66.4424 25.8047C66.8219 25.4148 67.1746 25.1902 67.5068 25.082L70.3389 27.668Z" fill="#85817E" />
                <path d="M45 130.501V140.501H130.001V130.501C130.001 126.834 127.201 119.001 116.001 117.001C110.073 116.012 101.216 116 87.5005 116C73.7854 116 64.9283 116.012 59 117.001C47.8 119.001 45 126.834 45 130.501Z" fill="#5C5957" />
                <path d="M88 116H87.984C73.9932 116 64.9977 116 59 117.001C47.8 119.001 45 126.834 45 130.501V140.501H130.001V130.501C130.001 126.834 127.201 119.001 116.001 117.001C110.003 116 101.008 116 87.017 116H87.001" stroke="black" strokeWidth="3" />
                <path d="M87.5 117.5C101.273 117.5 109.971 117.516 115.746 118.479C122.317 119.654 125.674 122.938 127.257 125.958C121.755 122.81 98.1869 122 86.5 122C68.0497 122 53.9346 124.453 47.7061 126.032C49.2728 122.992 52.6303 119.664 59.2539 118.479C65.0292 117.516 73.727 117.5 87.5 117.5Z" fill="#84807D" />
            </svg>

        ),

        bQ: ({ squareWidth }: { squareWidth: number }) => (
            <svg width={squareWidth} height={squareWidth} viewBox="0 0 162 162" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M129 70.9996L110 116.5C99.3333 115.666 72.7 114.399 51.5 116L32.5 70.4996C29 69.4996 23.0004 65 23 58.4996C23 54.5 27.4996 47.4996 34.9996 47.4996C37.9996 47.4996 45.9996 50 45.9996 58.4996C45.9996 60 45.6996 63.8 44.4996 65L57.9996 79L58.9996 47C55.8329 44.8333 51.9996 42 51.9996 34.5C51.9996 32 54.4996 23 62.9996 23C70.4996 23 75.4996 28 75.4996 34C75.4996 38 74.8996 43.3 70.4996 44.5L80.5 72L91.0004 45C86.6004 43.8 86.0004 38.5 86.0004 34.5C86.0004 28.5 91.0004 23.5 98.5004 23.5C107 23.5 109.5 32.5 109.5 35C109.5 42.5 105.667 45.3333 102.5 47.5L103.5 79.5L117 65.5C115.8 64.3 115.5 60.5 115.5 58.9996C115.5 50.5 123.5 47.9996 126.5 47.9996C134 47.9996 138.5 55 138.5 58.9996C138.5 65.5 132.5 69.9996 129 70.9996Z" fill="#5C5957" stroke="black" strokeWidth="3" />
                <path d="M133.5 52.5C133.602 52.5255 133.708 52.5635 133.817 52.6094C133.951 52.7418 134.081 52.8762 134.207 53.0137C136.085 55.0631 137 57.4673 137 59C137 61.7653 135.725 64.1654 133.969 66.0352C132.196 67.9226 130.049 69.14 128.588 69.5576L127.894 69.7559L109.032 114.925C103.472 114.516 94.4551 114.032 84.2764 113.829C89.2306 112.653 100.757 104.978 117.5 79.5L124 67.5C124.333 66.8333 125.4 65.4 127 65C130.167 64.1667 135.9 60.1 133.5 52.5Z" fill="#474543" />
                <path d="M105.18 28.123C105.453 28.4491 105.706 28.7879 105.936 29.1377C107.47 31.4673 108.001 34.0575 108.001 35C108.001 38.4706 107.122 40.7453 105.964 42.3848C104.779 44.0613 103.232 45.1819 101.654 46.2617L100.976 46.7256L101.544 64.9131C99.4124 59.7466 95.7705 49.4341 98.0006 42C99.8998 38.7105 105.951 32.1959 105.18 28.123Z" fill="#474543" />
                <path d="M39.7002 50.377C40.056 50.5724 40.4109 50.79 40.7559 51.0352C42.7953 52.4843 44.5 54.8057 44.5 58.5C44.5 59.1776 44.4295 60.4151 44.2217 61.6045C44.1179 62.1984 43.9861 62.7426 43.8281 63.1826C43.6605 63.6495 43.5085 63.8694 43.4385 63.9395L42.3975 64.9805L47.8086 70.5918L38.5 63.5C38.5 60.1665 40.8582 53.1139 39.7002 50.377Z" fill="#474543" />
                <path d="M71.9176 28.2715C73.2655 29.8907 74.0006 31.8923 74.0006 34C74.0006 35.9583 73.8476 38.0729 73.2359 39.7988C72.6396 41.4813 71.6791 42.6233 70.1051 43.0527L68.5338 43.4814L74.7867 60.6777C71.494 55.6867 63.9516 44.9133 65.0006 41C65.9323 37.5229 71.2017 31.9307 71.9176 28.2715Z" fill="#474543" />
                <path d="M38 130.501V140.501H123.001V130.501C123.001 126.834 120.201 119.001 109.001 117.001C103.073 116.012 94.2155 116 80.5005 116C66.7854 116 57.9283 116.012 52 117.001C40.8 119.001 38 126.834 38 130.501Z" fill="#5C5957" />
                <path d="M81 116H80.984C66.9932 116 57.9977 116 52 117.001C40.8 119.001 38 126.834 38 130.501V140.501H123.001V130.501C123.001 126.834 120.201 119.001 109.001 117.001C103.003 116 94.0078 116 80.017 116H80.001" stroke="black" strokeWidth="3" />
                <path d="M80.4941 117.5C94.267 117.5 102.965 117.516 108.74 118.479C115.311 119.654 118.668 122.938 120.251 125.958C114.749 122.81 91.1811 122 79.4941 122C61.0438 122 46.9287 124.453 40.7002 126.032C42.2669 122.992 45.6244 119.664 52.248 118.479C58.0233 117.516 66.7211 117.5 80.4941 117.5Z" fill="#84807D" />
                <path d="M124.859 49.7148C120.502 53.0126 118.286 58.7612 117.346 62.4619C117.322 62.3454 117.299 62.2265 117.278 62.1055C117.07 60.9161 117 59.6786 117 59.001C117 55.3067 118.705 52.9853 120.744 51.5361C122.12 50.5583 123.637 49.9917 124.859 49.7148Z" fill="#85817E" />
                <path d="M120.234 48.3164C119.882 48.5146 119.532 48.7311 119.188 48.9668L119.5 48.501L120.234 48.3164Z" fill="#85817E" />
                <path d="M97.0586 25.0703C91.341 28.8944 88.7412 34.7461 87.8496 38.7529C87.5794 37.3886 87.5 35.9037 87.5 34.499C87.5 29.8183 91.111 25.6519 97.0586 25.0703Z" fill="#85817E" />
                <path d="M63.3701 24.5068C57.7191 28.328 55.0212 34.2952 53.9912 38.5498C53.6834 37.4125 53.5 36.0804 53.5 34.5C53.5 33.5575 54.0304 30.9673 55.5645 28.6377C57.0521 26.3787 59.3811 24.5 63 24.5C63.1243 24.5 63.2476 24.5039 63.3701 24.5068Z" fill="#85817E" />
                <path d="M34.2119 49.0312C29.1148 52.2415 26.536 58.2491 25.498 62.6484C24.9472 61.5355 24.5896 60.3185 24.5146 59.0146L24.5 58.501C24.5 56.9683 25.4145 54.5641 27.293 52.5146C28.9797 50.6744 31.3257 49.2526 34.2119 49.0312Z" fill="#85817E" />
            </svg>


        ),
        bK: ({ squareWidth }: { squareWidth: number }) => (
            <svg width={squareWidth} height={squareWidth} viewBox="0 0 162 162" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M89.9997 28H99.4997V46H90.946L92.4626 51.7627C102.552 46.5 111.567 46.756 118.806 49.4033C126.146 52.0877 131.576 57.193 134.468 61.2646L134.739 61.6553L134.771 61.7012L134.799 61.75C139.059 69.1294 139.367 76.7111 138.207 82.8271C137.627 85.8834 136.678 88.5917 135.658 90.7559C134.651 92.8921 133.532 94.5887 132.56 95.5605C126.624 101.496 117.009 113.099 113.218 118.375L112.69 119.109L111.795 118.986C88.7745 115.811 60.9768 117.663 49.9685 118.989L49.0886 119.096L48.571 118.375C44.7791 113.099 35.1641 101.496 29.2283 95.5605C28.2564 94.5887 27.1375 92.8922 26.1306 90.7559C25.1106 88.5916 24.1616 85.8834 23.5818 82.8271C22.4216 76.711 22.7294 69.1295 26.99 61.75L27.0183 61.7012L27.0495 61.6553C29.8652 57.5248 35.4059 52.1742 42.9822 49.4033C50.2211 46.7561 59.2365 46.4999 69.3259 51.7627L70.8435 46H62.2888V28H71.7888V18H89.9997V28ZM54.8445 69.9785L54.1531 70.002L53.9958 70.0098L53.8435 70.0508C49.886 71.1114 47.9547 73.6598 47.2868 76.4287C46.6499 79.0699 47.1754 81.8065 47.8298 83.5312L47.9284 83.791L61.0603 98.499H70.2322V75.3779L69.7927 74.9385C67.5147 72.6606 64.3756 71.4044 61.5154 70.7275C58.9974 70.1317 56.5628 69.9532 54.8445 69.9785ZM106.387 69.9785C104.669 69.9532 102.234 70.1317 99.7165 70.7275C96.8564 71.4044 93.7172 72.6607 91.4392 74.9385L90.9997 75.3779V98.499H100.172L113.303 83.791L113.402 83.5312C114.057 81.8066 114.582 79.0698 113.945 76.4287C113.277 73.6599 111.346 71.1114 107.388 70.0508L107.236 70.0098L107.079 70.002L106.387 69.9785Z" fill="#5C5957" />
                <path d="M131.499 94.5C125.499 100.5 115.832 112.167 111.999 117.5C88.7992 114.3 60.8585 116.167 49.7882 117.5C45.9548 112.167 36.2882 100.5 30.2882 94.5C27.0821 91.2939 20.2053 76.5 28.2882 62.5C33.6279 54.6667 49.5036 42 70.2882 54L72.7882 44.5H63.7882V29.5H73.2882V19.5H88.4991V29.5H97.9991V44.5H88.9991L91.4991 54C112.284 42 128.159 54.6667 133.499 62.5C141.582 76.5 134.705 91.2939 131.499 94.5Z" stroke="black" strokeWidth="3" />
                <path d="M38.499 130.501V140.501H123.5V130.501C123.5 126.834 120.7 119.001 109.5 117.001C103.572 116.012 94.7146 116 80.9995 116C67.2845 116 58.4274 116.012 52.499 117.001C41.299 119.001 38.499 126.834 38.499 130.501Z" fill="#5C5957" />
                <path d="M81.499 116H81.483C67.4922 116 58.4967 116 52.499 117.001C41.299 119.001 38.499 126.834 38.499 130.501V140.501H123.5V130.501C123.5 126.834 120.7 119.001 109.5 117.001C103.502 116 94.5068 116 80.516 116H80.5" stroke="black" strokeWidth="3" />
                <path d="M80.9932 118C94.766 118 103.464 118.016 109.239 118.979C115.81 120.154 119.167 123.438 120.75 126.458C115.248 123.31 91.6801 122.5 79.9932 122.5C61.5429 122.5 47.4278 124.953 41.1992 126.532C42.7659 123.492 46.1235 120.164 52.7471 118.979C58.5224 118.016 67.2202 118 80.9932 118Z" fill="#84807D" />
                <path d="M99.499 96.9995H92.499V75.9995C96.499 71.9995 103.832 71.3328 106.999 71.4995C113.799 73.3216 113.166 79.9254 111.999 82.9995L99.499 96.9995Z" stroke="black" strokeWidth="3" />
                <path d="M61.7324 96.9995H68.7324V75.9995C64.7324 71.9995 57.3991 71.3328 54.2324 71.4995C47.4324 73.3216 48.0658 79.9254 49.2324 82.9995L61.7324 96.9995Z" stroke="black" strokeWidth="3" />
                <path d="M130.983 61.6484C131.447 62.2152 131.863 62.7677 132.226 63.2969C136.023 69.9031 136.315 76.7 135.259 82.2695C134.729 85.0622 133.863 87.5288 132.944 89.4775C132.013 91.4541 131.07 92.8093 130.438 93.4404C124.636 99.2432 115.488 110.235 111.315 115.896C108.156 115.479 104.917 115.156 101.65 114.908C110.386 106.979 128.324 88.5 131.499 83.001C134.674 77.502 132.834 67.7133 130.983 61.6484Z" fill="#464442" />
                <path d="M86.999 31H96.499V32.5H85.499V30.5H86.999V31Z" fill="#85817E" />
                <path d="M44.0121 52.2216C48.812 50.4661 54.5411 49.8484 60.9994 51.6454L62.999 52.2216C48.5993 52.2217 36.9995 59.5 33.9994 62.9999C26.2945 71.4387 28.0979 85.0094 30.3783 92.2138C29.9029 91.512 29.3709 90.5941 28.8441 89.4765C27.9257 87.5277 27.0585 85.0612 26.5287 82.2685C25.4722 76.6991 25.7638 69.9018 29.5609 63.2958C32.0961 59.5989 37.1499 54.7314 44.0121 52.2216Z" fill="#85817E" />
                <path d="M86.999 21V22.5H76.499V32.5H66.499V41.5H65.2881V31H74.7881V21H86.999Z" fill="#85817E" />
            </svg>
        ),
    };

    useEffect(() => {
        // Load ECO databases
        const loadEcoData = async () => {
            try {
                const [ecoA, ecoB, ecoC, ecoD, ecoE] = await Promise.all([
                    fetch('/eco-openings/ecoA.json').then(r => r.json()),
                    fetch('/eco-openings/ecoB.json').then(r => r.json()),
                    fetch('/eco-openings/ecoC.json').then(r => r.json()),
                    fetch('/eco-openings/ecoD.json').then(r => r.json()),
                    fetch('/eco-openings/ecoE.json').then(r => r.json())
                ]);

                // Merge all ECO databases into one object
                const allEcoData = { ...ecoA, ...ecoB, ...ecoC, ...ecoD, ...ecoE };
                setEcoDatabase(allEcoData);
                setEcoLoaded(true);

            } catch (error) {
                console.error('Failed to load ECO databases:', error);
            }
        };

        loadEcoData();
    }, []);


    useEffect(() => {
        stockfishRef.current = new Worker('/about-me/chessEngine/stockfish-17-lite-single.js');
        stockfishRef.current.postMessage('uci');
        stockfishRef.current.postMessage('setoption name UCI_LimitStrength value true');
        stockfishRef.current.postMessage('setoption name UCI_Elo value 1700');
        stockfishRef.current.postMessage('isready');

        return () => {
            stockfishRef.current?.terminate();
        };
    }, []);

    function extractMovesFromPGN(pgn: string): string {
        const lines = pgn.split('\n');

        // Find the line with moves (doesn't start with [)
        const moveLine = lines.find(line => line.trim() && !line.startsWith('['));

        if (!moveLine) return '';

        const cleanedMoves = moveLine.replace(/\s*\*\s*$/, '').trim();
        return cleanedMoves;
    }

    function findOpeningByPGN() {
        if (!ecoLoaded) return null;

        const fullPGN = chessGameRef.current.pgn();
        if (!fullPGN) return null;

        const currentMoves = extractMovesFromPGN(fullPGN);
        if (!currentMoves) return null;

        // Search through all ECO entries for best match
        let bestMatch = null;
        let longestMatch = 0;

        for (const opening of Object.values(ecoDatabase) as any[]) {
            if (opening.moves && currentMoves.startsWith(opening.moves)) {
                if (opening.moves.length > longestMatch) {
                    longestMatch = opening.moves.length;
                    bestMatch = opening;
                }
            }
        }

        return bestMatch;
    }

    function updateCapturedPieces(move: any) {
        if (move.captured) {
            if (move.color === 'w') {
                setCapturedByWhite(prev => [...prev, move.captured]);
            } else {
                setCapturedByBlack(prev => [...prev, move.captured]);
            }
        }
    }

    // Handle user move
    function onPieceDrop(sourceSquare: string, targetSquare: string, piece: Piece) {
        if (waitingForBot) return false;

        let move;

        try {
            move = chessGameRef.current.move({
                from: sourceSquare,
                to: targetSquare,
                ...(promotionPieceRef.current && { promotion: promotionPieceRef.current })
            });

            if (!move) {
                return false;
            }

            // Clear promotion piece and illegal move state after successful move
            promotionPieceRef.current = null;
            setAvatarState('thinking');
            setLastIllegalMove(null);

            // Play sound based on priority: check > castle > capture > move
            if (chessGameRef.current.inCheck()) {
                playSound('check');
            } else if (move.isKingsideCastle() || move.isQueensideCastle()) {
                playSound('castle');
            } else if (move.captured) {
                playSound('capture');
            } else {
                playSound('move');
            }

            updateCapturedPieces(move);

            setChessPosition(chessGameRef.current.fen());
            setMoveHistory(chessGameRef.current.history());
            setCurrentOpening(findOpeningByPGN());
            extractMovesFromPGN(chessGameRef.current.pgn())

            setTimeout(makeStockfishMove, 200);
            return true;


        } catch (error) {
            setLastIllegalMove({ from: sourceSquare, to: targetSquare });
            setAvatarState('illegal');
            return false;
        }
    }

    // Ask Stockfish for a move and play it
    function makeStockfishMove() {
        if (!stockfishRef.current) return;

        setWaitingForBot(true);

        stockfishRef.current.postMessage('position fen ' + chessGameRef.current.fen());
        stockfishRef.current.postMessage('go depth 20');
        stockfishRef.current.onmessage = (event) => {

            // Parse evaluation from Stockfish output
            const evalMatch = event.data.match(/score cp (-?\d+)/);
            if (evalMatch) {
                const centipawns = parseInt(evalMatch[1]);
                setPositionEval(centipawns);
            }

            const match = event.data.match(/bestmove ([a-h][1-8][a-h][1-8][qrbn]?)/);
            if (match) {
                // Check if the game is still in progress before making a move
                if (chessGameRef.current.isGameOver() || gameStatus.includes('resigned')) {
                    setWaitingForBot(false);
                    return;
                }

                const move = chessGameRef.current.move({
                    from: match[1].slice(0, 2),
                    to: match[1].slice(2, 4),
                    promotion: match[1][4]
                });

                if (!move) {
                    console.error('Illegal move attempted:');
                    return false;
                }

                // Play sound based on priority: check > castle > capture > move-computer
                if (chessGameRef.current.inCheck()) {
                    playSound('check');
                } else if (move.isKingsideCastle() || move.isQueensideCastle()) {
                    playSound('castle');
                } else if (move.captured) {
                    playSound('capture');
                } else {
                    playSound('move-computer');
                }

                updateCapturedPieces(move);
                setChessPosition(chessGameRef.current.fen());
                setMoveHistory(chessGameRef.current.history());
                setCurrentOpening(findOpeningByPGN());
                extractMovesFromPGN(chessGameRef.current.pgn())

                // Only set waiting to false when we actually get the best move
                setWaitingForBot(false);
            }
        };
    }

    // Handle promotion piece selection
    function onPromotionPieceSelect(piece?: string, promoteFromSquare?: string, promoteToSquare?: string) {
        if (!piece || !promoteFromSquare || !promoteToSquare) return false;

        const promotionPiece = piece.toLowerCase().slice(1);
        promotionPieceRef.current = promotionPiece;

        return true;
    }

    // Resign function
    function handleResign() {
        const game = chessGameRef.current;

        if (chessGameRef.current.history().length == 0) {
            return
        }

        // Stop Stockfish worker immediately to prevent memory errors
        if (stockfishRef.current) {
            stockfishRef.current.postMessage('stop');
            stockfishRef.current.postMessage('ucinewgame');
            stockfishRef.current.postMessage('isready');
        }

        setGameStatus('You resigned - Computer wins!');
        setWaitingForBot(false);

        // Update the position to trigger re-render
        setChessPosition(game.fen());
    }

    // Undo function
    function handleUndo() {
        if (waitingForBot) return;
        const game = chessGameRef.current;
        if (game.history().length >= 2) {
            game.undo(); // Undo computer move
            game.undo(); // Undo player move
            setChessPosition(game.fen());
            setMoveHistory(game.history());
        }
    }

    // New Game function
    function handleNewGame() {

        // Inform Stockfish of the new game
        if (stockfishRef.current) {
            stockfishRef.current.postMessage('stop');
            stockfishRef.current.postMessage('ucinewgame');
            stockfishRef.current.postMessage('isready');
        }

        chessGameRef.current = new Chess();
        setChessPosition(chessGameRef.current.fen());
        setMoveHistory([]);
        setGameStatus('Game in progress');
        setWaitingForBot(false);
        setCapturedByWhite([]);
        setCapturedByBlack([]);
    }

    // Component to display captured pieces using SVG
    function CapturedPieces({ pieces, isWhiteCaptures }: { pieces: string[], isWhiteCaptures: boolean }) {
        const getPieceSvg = (piece: string) => {
            // Convert chess.js piece notation to SVG piece key
            const pieceColor = isWhiteCaptures ? 'b' : 'w'; // Opposite color of capturer
            const pieceKey = `${pieceColor}${piece.toUpperCase()}` as keyof typeof customPiecesSVG;

            if (customPiecesSVG[pieceKey]) {
                return customPiecesSVG[pieceKey]({ squareWidth: 24 });
            }

            return <span>{piece}</span>;
        };

        return (
            <div className="flex flex-wrap gap-1 mt-1">
                {pieces.map((piece, index) => (
                    <div key={index} className="w-6 h-6 shrink-0">
                        {getPieceSvg(piece)}
                    </div>
                ))}
            </div>
        );
    }

    function getGameReaction() {

        // Check for illegal move first
        if (avatarState === 'illegal' && lastIllegalMove) {
            return { avatar: '/avatars/laughing.png', message: "Bro really tried that? That's not how chess works " };
        }

        const game = chessGameRef.current;
        const lastMove = game.history({ verbose: true }).pop();

        // Game start
        if (game.history().length === 0) {
            return { avatar: '/avatars/waving.png', message: "Alright, let's see what you got. Your move." };
        }

        // Game over conditions
        if (game.isGameOver()) {
            if (game.isCheckmate()) {
                const turn = game.turn();
                if (turn === 'w') {
                    return { avatar: '/avatars/happy.png', message: "GG EZ. Better luck next time!" };
                } else {
                    return { avatar: '/avatars/rage.png', message: "Wait what?! Okay fine, you got me this time." };
                }
            } else {
                return { avatar: '/avatars/thinking.png', message: "A draw? Meh. Let's run it back." };
            }
        }

        // Resignation
        if (gameStatus.includes('resigned')) {
            return { avatar: '/avatars/smug.png', message: "Giving up already? I was just getting started!" };
        }

        // During game - check for captures
        if (lastMove?.captured && lastMove?.color === 'w') {
            return { avatar: '/avatars/surprised.png', message: "Hey! That was my favorite piece!" };
        }

        if (positionEval > 100) {
            return { avatar: '/avatars/smug.png', message: "Things are looking pretty good for me rn " };
        }
        else if (positionEval < -100) {
            return { avatar: '/avatars/concerned.png', message: "Okay okay, you're cooking. I see you." };
        }
        else if (waitingForBot) {
            return { avatar: '/avatars/thinking.png', message: "Hmm, let me think about this one..." };
        }
        else {
            return { avatar: '/avatars/default.png' };
        }
    }



    return (
        <main className="flex min-h-screen w-full h-screen w-full h-full shadow-lg md:items-center">
            <div className="flex flex-col w-full max-w-[520px] mx-auto gap-6 p-6 rounded-lg md:flex-row md:gap-8 md:items-stretch md:flex-1 md:justify-center md:min-h-[640px] md:max-h-[90vh] md:max-w-[1400px] md:mb-16">
                <div className='shadow-md order-2 md:order-1 p-4 border-1 border bg-component rounded-lg flex flex-col gap-4 md:max-w-[630px] md:flex-1 md:grow md:shrink'>
                    <div className='flex flex-row gap-2 w-full'>
                        <Avatar className='size-10 overflow-clip bg-background rounded-sm md:size-14'>
                            <AvatarImage src="/avatars/default.png" />
                            <AvatarFallback>CN</AvatarFallback>
                        </Avatar>
                        <div className='flex flex-col'>
                            <div className='flex items-center h-fit gap-1'>
                                <p className='text-lg font-bold'> TAN </p>
                            </div>
                            <CapturedPieces pieces={capturedByBlack} isWhiteCaptures={false} />
                        </div>
                    </div>

                    <div className='grow min-h-0 flex items-center justify-center'>
                        <div className="w-full max-w-[60vh] aspect-square mx-auto">
                            <Chessboard
                                position={chessPosition}
                                showBoardNotation={false}
                                onPieceDrop={onPieceDrop}
                                onPromotionPieceSelect={onPromotionPieceSelect}
                                id="play-vs-stockfish"
                                animationDuration={300}
                                allowDragOutsideBoard={true}
                                customBoardStyle={{ width: '100%', height: '100%' }}
                                customDarkSquareStyle={{ backgroundColor: "#4B7399", }}
                                customLightSquareStyle={{ backgroundColor: "#EAE9D2", }}
                                promotionDialogVariant='vertical'
                                customPieces={customPiecesSVG}
                            />
                        </div>
                    </div>


                    <div className='flex flex-row gap-2'>
                        <div className='flex flex-row gap-2'>
                            <div className='flex flex-col'>
                                <div className='flex items-center h-fit gap-1'>
                                </div>
                                <CapturedPieces pieces={capturedByWhite} isWhiteCaptures={true} />
                            </div>
                        </div>
                        <div className='w-full flex items-end justify-end md:hidden'>
                            <div className='w-fit flex flex-row gap-4 rounded-lg '>
                                {chessGameRef.current.isGameOver() ? (
                                    <Button className='gap-2 w-full' variant="secondary" onClick={handleNewGame}>
                                        <RotateCcw className='size-4' /> New Game
                                    </Button>
                                ) : (
                                    <>
                                        <Button className='gap-2 w-full' variant="secondary" onClick={handleResign}>
                                            <Flag className='size-4' /> Resign
                                        </Button>

                                        <Button className='gap-2 w-full' variant="secondary" onClick={handleUndo}>
                                            <Undo2 className='size-4' /> Undo
                                        </Button>
                                    </>
                                )}
                            </div>
                        </div>
                    </div>
                </div>

                <div className="shadow-md order-1 flex flex-col rounded-lg items-center bg-component border-1 border md:flex-1 md:max-w-[500px] ">
                    <div className="w-full flex flex-row gap-2 rounded-lg p-4 md:flex-1 md:items-center md:max-h-[240px] md:p-8">
                        <Avatar className='w-24 h-24 md:w-32 md:h-32 shrink-0'>
                            <AvatarImage src={getGameReaction().avatar} />
                        </Avatar>
                        {getGameReaction().message && (
                            <div className='flex flex-row items-center w-full animate-in fade-in slide-in-from-left-2 duration-300'>
                                <svg className='text-primary' width="20" height="29" viewBox="0 0 20 29" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M20 0V28.8937C9.33333 29.9688 2.22222 22.6222 0 18.8145C11.7333 16.1267 18.2222 5.15159 20 0Z" fill="currentColor" />
                                </svg>

                                <div className='flex flex-col gap-2 bg-primary p-4 rounded-lg w-fit'>
                                    <span className='text-sm w-full text-primary-foreground'>{getGameReaction().message}</span>
                                </div>
                            </div>
                        )}
                    </div>


                    <div className='w-full flex flex-col gap-2 hidden md:flex'>
                        <Separator className="flex mix-blend-multiply dark:mix-blend-lighten"></Separator>
                        <div className="p-3 rounded-lg">
                            <div className="text-sm font-medium">{currentOpening?.name || 'Starting position'}</div>
                        </div>
                        <Separator className="flex mix-blend-multiply dark:mix-blend-lighten"></Separator>
                    </div>


                    <div className="w-full p-4 rounded-lg hidden md:flex md:flex-1 overflow-hidden">
                        <div className="w-full h-full max-h-[200px] overflow-y-auto">
                            {moveHistory.length === 0 ? (
                                <p className="text-sm text-gray-600">No moves yet</p>
                            ) : (
                                <div className="grid grid-cols-2 gap-2 text-sm">
                                    {moveHistory.map((move, index) => (
                                        <div key={index} className="flex">
                                            {index % 2 === 0 && (
                                                <span className="w-6 text-gray-500">{Math.floor(index / 2) + 1}.</span>
                                            )}
                                            <span className={index % 2 === 0 ? "text-black dark:text-white" : "text-gray-700 dark:text-gray-300"}>
                                                {move}
                                            </span>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    </div>

                    <Separator className="flex mix-blend-multiply dark:mix-blend-lighten"></Separator>

                    <div className='p-4 flex flex-row gap-4 items-center justify-center hidden md:flex md:w-full'>
                        {chessGameRef.current.isGameOver() || gameStatus.includes('resigned') ? (
                            <Button className='gap-2 w-full' variant="secondary" onClick={handleNewGame}>
                                <RotateCcw className='size-4' /> New Game
                            </Button>
                        ) : (
                            <>
                                <Button className='gap-2 w-full' variant="secondary" onClick={handleResign}>
                                    <Flag className='size-4' /> Resign
                                </Button>

                                <Button className='gap-2 w-full' variant="secondary" onClick={handleUndo}>
                                    <Undo2 className='size-4' /> Undo
                                </Button>
                            </>
                        )}
                    </div>

                </div>


            </div >
            <BackgroundBeams></BackgroundBeams>
        </main >

    );
}
